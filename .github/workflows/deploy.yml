name: Deploy Vistorian 2.0 # name for your action

on:
  push: 
    branches:   #  Set a branch name to trigger action
      - master
    paths:
      - dist/**  # also match to subdirectories, * will only match to files in the current directory
  # pull_request:  # perform action after pr

jobs:
  deploy:
    runs-on: ubuntu-latest   # action perform environment
    concurrency: ci-${{ github.ref }}
    steps: 
      - name: Checkout
        uses: actions/checkout@v3 # check out your repository's code for the workflow to access and perform actions on it.

      - name: Checkout Public Repo
        uses: actions/checkout@v3 
        with: 
          repository: shuxinhuan/vistorian2.0_dev
          # token: ${{ secrets.TOKEN_VISTORIAN }}

      - name: Empty Public Repo
        run: |
          rm -rf ./*
          git config --global user.email "vlanxin11@gmail.com"
          git config --global user.name "Shu Xinhuan"
          git add .
          git commit -m "deploy"
          git push

      - name: Checkout Private Repo
        uses: actions/checkout@v3 
        with: 
          repository: shuxinhuan/vistorian2.0
        #   token: {{ secrets.TOKEN_VISTORIAN }}

      - name: Copy Dist folder
        run: |
          cp -r dist/* shuxinhuan/vistorian2.0_dev
      
      - name: Checkout Public Repo
        uses: actions/checkout@v3 # check out your repository's code for the workflow to access and perform actions on it.
        with: 
          repository: shuxinhuan/vistorian2.0_dev
        #   token: {{ secrets.TOKEN_VISTORIAN }}

      - name: Commit Changes
        run: |
          cd vistorian2.0_dev
          git add .
          git commit -m "deploy"
          git push
          